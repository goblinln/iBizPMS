{
  "dBType" : "MYSQL5",
  "name" : "MySQL5",
  "getPSDEDataQueryCodeConds" : [ {
    "condType" : "CUSTOM",
    "customCond" : "t1.DELETED = '0'",
    "name" : "查询条件"
  }, {
    "condType" : "CUSTOM",
    "customCond" : "FIND_IN_SET (#{srf.datacontext.srfparentkey}, t11.`PATH`)",
    "name" : "查询条件"
  }, {
    "condType" : "CUSTOM",
    "customCond" : "( t1.`PARENT` = 0  or  t1.`PARENT` = -1)",
    "name" : "查询条件"
  } ],
  "queryCode" : "SELECT t1.id, t1.`ASSIGNEDDATE`, t1.`ASSIGNEDTO`, t1.`CANCELEDBY`, t1.`CANCELEDDATE`, t1.`CLOSEDBY`, t1.`CLOSEDDATE`, t1.`CLOSEDREASON`, t1.`COLOR`, t1.`CONSUMED`, t1.`DEADLINE`, t1.`DELETED`, (select (case when COUNT(t.IBZ_FAVORITESID) > 0 then 1 else 0 end ) as ISFAVORITES from T_IBZ_FAVORITES t where t.TYPE = 'task' and t.ACCOUNT = #{srf.sessioncontext.srfloginname} and t.OBJECTID = t1.id) AS `ISFAVORITES`, (To_Days(t1.`DEADLINE`)-To_Days(t1.`ESTSTARTED`)) AS `DURATION`, t1.`ESTIMATE`, t1.`ESTSTARTED`, t1.`FINISHEDBY`, t1.`FINISHEDDATE`, t1.`FROMBUG`,case when t1.`status` = 'wait' then CONCAT_WS('',60,LPAD(t1.id,12,0)) when t1.`status` = 'doing' then  CONCAT_WS('',50,LPAD(t1.id,12,0)) when  t1.`status` = 'done' then  CONCAT_WS('',40,LPAD(t1.id,12,0)) when  t1.`status` = 'closed' then  CONCAT_WS('',30,LPAD(t1.id,12,0)) when  t1.`status` = 'cancel' then  CONCAT_WS('',20,LPAD(t1.id,12,0))  else  CONCAT_WS('',10,LPAD(t1.id,12,0)) end as `TASKSN`, (case when t1.deadline is null or t1.deadline = '0000-00-00' or t1.deadline = '1970-01-01' then '' when t1.`status` in ('wait','doing') and t1.deadline <DATE_FORMAT(now(),'%y-%m-%d')  then CONCAT_WS('','延期',TIMESTAMPDIFF(DAY, t1.deadline, now()),'天') else '' end) as DELAY, t1.`LASTEDITEDBY`, t1.`LASTEDITEDDATE`, t1.`LEFT`, t1.`MODULE`, t11.`NAME` AS `MODULENAME`, t1.`NAME`, t1.`OPENEDBY`, t1.`OPENEDDATE`, t1.`PARENT`, t51.`NAME` AS `PARENTNAME`, t11.`PATH`, t1.`PRI`, t21.`PRODUCT`, t41.`NAME` AS `PRODUCTNAME`, t1.`PROJECT`, t31.`NAME` AS `PROJECTNAME`, t1.`REALSTARTED`, t1.`STATUS`, t1.`STORY`, t21.`TITLE` AS `STORYNAME`, t1.`STORYVERSION`, t1.`SUBSTATUS`, t1.`TYPE`, ( CASE WHEN ( SELECT CASE\t WHEN count( t.`id` ) > 0 THEN 1 ELSE 0  END  FROM `zt_team` t  WHERE t.`type` = 'task'  AND t.`root` = t1.`ID`  ) = 1 THEN '10'  WHEN t1.parent = - 1 THEN'20'   WHEN t1.parent = 0 THEN '30' ELSE '40' END) AS `TASKTYPE`, CONCAT_WS('',case when t1.consumed = 0 or t1.consumed is null then '0' when t1.`left` = 0 or t1.`left` is null then '100' else ROUND((ROUND(t1.`consumed`/(t1.`left` + t1.consumed),2)) * 100) end ,'%') as progressrate, (case when t1.storyVersion < t21.version and t21.`status` <> 'changed' then 'storychange'  else t1.`status` end ) as `STATUS1`,\n 0  as statusorder ,\nt1.`PLAN`,\nt61.`TITLE` AS `PLANNAME` FROM\n\t`zt_task` t1\n\tLEFT JOIN zt_module t11 ON t1.MODULE = t11.ID\n\tLEFT JOIN zt_story t21 ON t1.STORY = t21.ID\n\tLEFT JOIN zt_project t31 ON t1.PROJECT = t31.ID\n\tLEFT JOIN zt_product t41 ON t21.PRODUCT = t41.ID\n\tLEFT JOIN zt_task t51 ON t1.PARENT = t51.ID\n\tLEFT JOIN `zt_productplan` t61 ON t1.`PLAN` = t61.`ID`",
  "id" : "PSMODULES/zentao/PSDATAENTITIES/Task/PSDEDATAQUERIES/ByModule/PSDEDQCODES/MYSQL5.json"
}