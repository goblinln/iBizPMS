{
  "dBType" : "MYSQL5",
  "name" : "MySQL5",
  "queryCode" : "SELECT t1.*,IFNULL(t2.storycnt,0) as storycnt,IFNULL(t3.taskcnt,0) as ycompletetaskcnt,IFNULL(t4.bugcnt,0) as bugcnt from (\nselect  \nt1.id,\nt1.`name`,\nt1.deleted,\nt1.OPENEDBY,\nt1.PO,\nt1.PM,\nt1.QD,\nt1.RD,\nt1.ACL,\nt1.ORGID,\nt1.MDEPTID\nfrom zt_project t1 where t1.id in ( SELECT t1.id from zt_project t1 where (YEAR(t1.`begin`) <= #{srf.webcontext.curyear} \nand YEAR(t1.`end`) >=#{srf.webcontext.curyear} ) and ( t1.openedBy =#{srf.sessioncontext.srfloginname}\nor t1.PO =#{srf.sessioncontext.srfloginname} \nor t1.PM =#{srf.sessioncontext.srfloginname}\nor t1.QD = #{srf.sessioncontext.srfloginname} \nor t1.RD = #{srf.sessioncontext.srfloginname}\n) ) or t1.id in ( select t1.root from zt_team t1 where t1.type = 'project' and t1.account =#{srf.sessioncontext.srfloginname} \nand \nYEAR(t1.`join`) =#{srf.webcontext.curyear} \n) or t1.id in  (SELECT DISTINCT t1.project from zt_task t1 LEFT JOIN zt_action t2 on t1.id = t2.OBJECTID and t2.objectType = 'task' where t2.actor =#{srf.sessioncontext.srfloginname}\n\nand t2.action = 'finished' and left(t2.date,4) =  #{srf.webcontext.curyear} \n)\n\n) t1 \nLEFT JOIN (\nSELECT count(1) as storycnt,t1.project from (\nselect t1.id,t1.`title`,t1.`status`,t2.project from zt_story t1 LEFT JOIN zt_projectstory t2 on t2.story = t1.id \n) t1 GROUP BY t1.project \n) t2 on t2.project = t1.id\nLEFT JOIN (\nselect  t1.project,count(1) as taskcnt from zt_task t1 where  t1.finishedBy = \n#{srf.sessioncontext.srfloginname} \nGROUP \nBY t1.project\n) t3 on t3.project = t1.id\nLEFT JOIN (\nSELECT  t1.project,count(1) as bugcnt from zt_bug t1 where  t1.resolvedBy = \n#{srf.sessioncontext.srfloginname}\t\nGROUP BY t1.project\n) t4 on t4.project = t1.id",
  "id" : "PSMODULES/zentao/PSDATAENTITIES/Project/PSDEDATAQUERIES/InvolvedProjectStoryTaskBug/PSDEDQCODES/MYSQL5.json"
}