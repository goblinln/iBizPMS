{
  "dBType" : "MYSQL5",
  "name" : "MySQL5",
  "queryCode" : "select t1.* from (SELECT\n(select tt.product from zt_projectproduct tt where tt.project = t1.id LIMIT 0,1)as products,\nt1.MDEPTID,\nt1.orgid,\nt1.`ACL`,\nt1.`BEGIN`,\n(SELECT COUNT(1) FROM ZT_BUG WHERE PROJECT = t1.`ID` AND DELETED = '0') AS `BUGCNT`,\nt1.`CANCELEDBY`,\n(select count(1) + 1 from zt_doclib where type = 'project' and project = t1.`id`) as `DOCLIBCNT`,\nt1.`CANCELEDDATE`,\nt1.`CATID`,\nt1.`CLOSEDBY`,\nt1.`CLOSEDDATE`,\nt1.`CODE`,\nt1.`DAYS`,\nt1.`DELETED`,\nt1.`END`,\nt1.`ID`,\nt1.`ISCAT`,\nt1.`NAME`,\nt1.`OPENEDBY`,\nt1.`OPENEDDATE`,\nt1.`OPENEDVERSION`,\nt1.`ORDER`,\n(CASE WHEN T2.OBJECTORDER IS NOT NULL THEN T2.OBJECTORDER ELSE  t1.`ORDER` END) as `ORDER1`,\n\t(CASE WHEN T2.OBJECTORDER IS NOT NULL THEN 1 ELSE 0 END) as `ISTOP`,\nt1.`PARENT`,\nt11.`NAME` AS `PARENTNAME`,\nt1.`PM`,\nt1.`PO`,\nt1.`PRI`,\nt1.`QD`,\nt1.`RD`,\nt1.`STATGE`,\nt1.`STATUS`,\n(SELECT COUNT(1) FROM ZT_STORY LEFT JOIN ZT_PROJECTSTORY ON ZT_STORY.ID = ZT_PROJECTSTORY.STORY WHERE PROJECT = t1.`ID` AND DELETED = '0') AS `STORYCNT`,\nt1.`SUBSTATUS`,\n(SELECT COUNT(1) FROM ZT_TASK WHERE PROJECT = t1.`ID` AND DELETED = '0') AS `TASKCNT`,\nt1.`TEAM`,\n(SELECT round(SUM(CONSUMED),0) FROM ZT_TASK WHERE PROJECT = t1.`ID` AND DELETED = '0' AND ( `parent` = '' or `parent` = '0' or `parent` = '-1')) AS `TOTALCONSUMED`,\n(SELECT round(SUM(ESTIMATE),0) FROM ZT_TASK WHERE PROJECT = t1.`ID` AND DELETED =  '0' AND ( `parent` = '' or `parent` = '0' or `parent` = '-1')) AS `TOTALESTIMATE`,\n(select sum(days * hours)  from zt_team tt where type = 'project' and root = t1.id) AS `TOTALHOURS`,\n(SELECT round(SUM(`LEFT`),0) FROM ZT_TASK WHERE PROJECT = t1.`ID` AND DELETED = '0' and `status` in ('doing','wait','pause') AND ( `parent` = '' or `parent` = '0' or `parent` = '-1')) AS `TOTALLEFT`,\n((SELECT round(SUM( `LEFT` ),0) FROM ZT_TASK WHERE PROJECT = t1.`ID` AND DELETED = '0' AND ( `parent` = '' OR `parent` = '0' OR `parent` = '-1' ) AND `status` in ('doing','wait','pause')) + (SELECT round(SUM( CONSUMED ),0) FROM ZT_TASK WHERE PROJECT = t1.`ID` AND DELETED = '0' AND ( `parent` = '' OR `parent` = '0' OR `parent` = '-1' ))) AS `TOTALWH`,\nt1.`TYPE`,\nt1.PROJECTSN\nFROM `zt_project` t1 \nleft join t_ibz_top t2 on t1.id = t2.OBJECTID and t2.type = 'project' and t2.ACCOUNT = #{srf.sessioncontext.srfloginname}\nLEFT JOIN zt_project t11 ON t1.PARENT = t11.PROJECTSN \nwhere t1.deleted = '0' and (t1.acl = 'open' or t1.OPENEDBY = #{srf.sessioncontext.srfloginname} or  t1.pm =  #{srf.sessioncontext.srfloginname} or t1.PO = #{srf.sessioncontext.srfloginname} or t1.RD = #{srf.sessioncontext.srfloginname} or t1.QD =  #{srf.sessioncontext.srfloginname} )\nunion \nSELECT\n(select tt.product from zt_projectproduct tt where tt.project = t1.id LIMIT 0,1)as products,\nt1.MDEPTID,\nt1.orgid,\nt1.`ACL`,\nt1.`BEGIN`,\n(SELECT COUNT(1) FROM ZT_BUG WHERE PROJECT = t1.`ID` AND DELETED = '0') AS `BUGCNT`,\nt1.`CANCELEDBY`,\n(select count(1) + 1 from zt_doclib where type = 'project' and project = t1.`id`) as `DOCLIBCNT`,\nt1.`CANCELEDDATE`,\nt1.`CATID`,\nt1.`CLOSEDBY`,\nt1.`CLOSEDDATE`,\nt1.`CODE`,\nt1.`DAYS`,\nt1.`DELETED`,\nt1.`END`,\nt1.`ID`,\nt1.`ISCAT`,\nt1.`NAME`,\nt1.`OPENEDBY`,\nt1.`OPENEDDATE`,\nt1.`OPENEDVERSION`,\nt1.`ORDER`,\n(CASE WHEN T2.OBJECTORDER IS NOT NULL THEN T2.OBJECTORDER ELSE  t1.`ORDER` END) as `ORDER1`,\n\t(CASE WHEN T2.OBJECTORDER IS NOT NULL THEN 1 ELSE 0 END) as `ISTOP`,\nt1.`PARENT`,\nt11.`NAME` AS `PARENTNAME`,\nt1.`PM`,\nt1.`PO`,\nt1.`PRI`,\nt1.`QD`,\nt1.`RD`,\nt1.`STATGE`,\nt1.`STATUS`,\n(SELECT COUNT(1) FROM ZT_STORY LEFT JOIN ZT_PROJECTSTORY ON ZT_STORY.ID = ZT_PROJECTSTORY.STORY WHERE PROJECT = t1.`ID` AND DELETED = '0') AS `STORYCNT`,\nt1.`SUBSTATUS`,\n(SELECT COUNT(1) FROM ZT_TASK WHERE PROJECT = t1.`ID` AND DELETED = '0') AS `TASKCNT`,\nt1.`TEAM`,\n(SELECT round(SUM(CONSUMED),0) FROM ZT_TASK WHERE PROJECT = t1.`ID` AND DELETED = '0' AND ( `parent` = '' or `parent` = '0' or `parent` = '-1')) AS `TOTALCONSUMED`,\n(SELECT round(SUM(ESTIMATE),0) FROM ZT_TASK WHERE PROJECT = t1.`ID` AND DELETED =  '0' AND ( `parent` = '' or `parent` = '0' or `parent` = '-1')) AS `TOTALESTIMATE`,\n(select sum(days * hours)  from zt_team tt where type = 'project' and root = t1.id) AS `TOTALHOURS`,\n(SELECT round(SUM(`LEFT`),0) FROM ZT_TASK WHERE PROJECT = t1.`ID` AND DELETED = '0' and `status` in ('doing','wait','pause') AND ( `parent` = '' or `parent` = '0' or `parent` = '-1')) AS `TOTALLEFT`,\n((SELECT round(SUM( `LEFT` ),0) FROM ZT_TASK WHERE PROJECT = t1.`ID` AND DELETED = '0' AND ( `parent` = '' OR `parent` = '0' OR `parent` = '-1' ) AND `status` in ('doing','wait','pause')) + (SELECT round(SUM( CONSUMED ),0) FROM ZT_TASK WHERE PROJECT = t1.`ID` AND DELETED = '0' AND ( `parent` = '' OR `parent` = '0' OR `parent` = '-1' ))) AS `TOTALWH`,\nt1.`TYPE`,\nt1.PROJECTSN\nFROM `zt_project` t1 \nleft join t_ibz_top t2 on t1.id = t2.OBJECTID and t2.type = 'project' and t2.ACCOUNT = #{srf.sessioncontext.srfloginname}\nLEFT JOIN zt_project t11 ON t1.PARENT = t11.PROJECTSN \nwhere t1.deleted = '0' and t1.acl = 'private' and t1.PROJECTSN in (select t3.root from zt_team t3 where t3.account = #{srf.sessioncontext.srfloginname}  \nand t3.type = 'project')) t1",
  "id" : "PSMODULES/zentao/PSDATAENTITIES/Project/PSDEDATAQUERIES/CurUserSa/PSDEDQCODES/MYSQL5.json"
}