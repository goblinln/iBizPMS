{
  "dBType" : "MYSQL5",
  "name" : "MySQL5",
  "getPSDEDataQueryCodeConds" : [ {
    "condType" : "CUSTOM",
    "customCond" : "t1.DELETED = '0'",
    "name" : "查询条件"
  }, {
    "condType" : "CUSTOM",
    "customCond" : "( t1.`STATUS` = 'normal' )",
    "name" : "查询条件"
  }, {
    "condType" : "CUSTOM",
    "customCond" : "(t1.id IN (\nSELECT\n\tt.product \nFROM\n\tzt_projectproduct t \nWHERE\n\tt.project IN (\nSELECT\n\tt3.root \nFROM\n\tzt_team t3 \nWHERE\n\tt3.account = #{srf.sessioncontext.srfloginname} \n\tAND t3.type = 'project' \n\t) \n\t) or  t1.acl = 'open')",
    "name" : "查询条件"
  } ],
  "getPSDEDataQueryCodeExps" : [ {
    "expression" : "(SELECT COUNT(1) FROM ZT_BUG WHERE PRODUCT = t1.`ID` AND `STATUS` = 'active' AND DELETED ='0')",
    "name" : "ACTIVEBUGCNT"
  }, {
    "expression" : "(SELECT COUNT(1) FROM ZT_STORY WHERE PRODUCT = t1.`ID` AND `STATUS`='active' AND DELETED = '0')",
    "name" : "ACTIVESTORYCNT"
  }, {
    "expression" : "1",
    "name" : "ASSIGNTOMEBUGCNT"
  }, {
    "expression" : "(SELECT COUNT(1) FROM ZT_BUG WHERE PRODUCT = t1.`ID` AND DELETED = '0')",
    "name" : "BUGCNT"
  }, {
    "expression" : "t1.`CODE`",
    "name" : "CODE"
  }, {
    "expression" : "(SELECT t.name FROM zt_project t,zt_projectproduct t2 WHERE t.id=t2.project and t2.product = t1.id limit 1)",
    "name" : "CURRPROJECT"
  }, {
    "expression" : "t1.`DELETED`",
    "name" : "DELETED"
  }, {
    "expression" : "(SELECT COUNT(1) FROM ZT_STORY WHERE PRODUCT = t1.`ID` AND STAGE = 'developing' AND DELETED = '0')",
    "name" : "DEVELOPINGSTORYCNT"
  }, {
    "expression" : "t1.`ID`",
    "name" : "ID"
  }, {
    "expression" : "t1.`NAME`",
    "name" : "NAME"
  }, {
    "expression" : "(SELECT COUNT(1) FROM ZT_RELEASE WHERE PRODUCT= t1.`ID` AND  `STATUS`= 'normal' AND DELETED = '0')",
    "name" : "NORMALRELEASECNT"
  }, {
    "expression" : "(SELECT COUNT(1) FROM ZT_BUG WHERE PRODUCT = t1.`ID` AND `STATUS` <> 'closed' AND DELETED = '0')",
    "name" : "NOTCLOSEDBUGCNT"
  }, {
    "expression" : "(SELECT COUNT(1) FROM ZT_STORY WHERE PRODUCT = t1.`ID` AND STAGE = 'planned' AND DELETED ='0')",
    "name" : "PLANNEDSTORYCNT"
  }, {
    "expression" : "(SELECT COUNT(1) FROM ZT_PROJECT t2 LEFT JOIN ZT_PROJECTPRODUCT t ON t2.ID = t.project WHERE t.PRODUCT = t1.id AND t2.DELETED = '0' and t2.`status` in( 'wait','doing') and t2.`END` < now() )",
    "name" : "POSTPONEDPROJECTCNT"
  }, {
    "expression" : "(SELECT COUNT(1) FROM ZT_PRODUCTPLAN WHERE PRODUCT= t1.`ID` AND DELETED = '0')",
    "name" : "PRODUCTPLANCNT"
  }, {
    "expression" : "(SELECT COUNT(1) FROM ZT_RELEASE WHERE PRODUCT= t1.`ID` AND DELETED = '0')",
    "name" : "RELEASECNT"
  }, {
    "expression" : "(SELECT COUNT(1) FROM ZT_STORY WHERE PRODUCT = t1.`ID` AND STAGE = 'released' AND DELETED = '0')",
    "name" : "RELEASEDSTORYCNT"
  }, {
    "expression" : "(SELECT COUNT(1) FROM ZT_PROJECT LEFT JOIN ZT_PROJECTPRODUCT ON  ZT_PROJECT.ID = ZT_PROJECTPRODUCT.project WHERE PRODUCT = t1.`ID` AND DELETED = '0')",
    "name" : "RESPROJECTCNT"
  }, {
    "expression" : "t1.`STATUS`",
    "name" : "STATUS"
  }, {
    "expression" : "(SELECT COUNT(1) FROM ZT_STORY WHERE PRODUCT = t1.`ID` AND DELETED = '0')",
    "name" : "STORYCNT"
  }, {
    "expression" : "(SELECT COUNT(1) FROM ZT_STORY WHERE PRODUCT = t1.`ID` AND STAGE = 'testing' AND DELETED = '0')",
    "name" : "TESTINGSTORYCNT"
  }, {
    "expression" : "t1.`TYPE`",
    "name" : "TYPE"
  }, {
    "expression" : "(SELECT COUNT(1) FROM ZT_BUG WHERE PRODUCT = t1.`ID` AND `CONFIRMED` = 0 AND DELETED = '0')",
    "name" : "UNCONFIRMBUGCNT"
  }, {
    "expression" : "(SELECT COUNT(1) FROM ZT_PROJECT LEFT JOIN ZT_PROJECTPRODUCT ON  ZT_PROJECT.ID = ZT_PROJECTPRODUCT.project WHERE PRODUCT = t1.`ID` AND `STATUS` <> 'closed' AND DELETED = '0')",
    "name" : "UNDONERESPROJECTCNT"
  }, {
    "expression" : "(SELECT COUNT(1) FROM ZT_PRODUCTPLAN WHERE PRODUCT= t1.`ID`  AND `END` > CURDATE() AND DELETED = '0')",
    "name" : "UNENDPRODUCTPLANCNT"
  }, {
    "expression" : "(SELECT COUNT(1) FROM ZT_STORY WHERE PRODUCT = t1.`ID` AND STAGE = 'wait' AND DELETED = '0')",
    "name" : "WAITSTORYCNT"
  }, {
    "expression" : "(SELECT COUNT( 1 ) FROM ZT_BUG WHERE PRODUCT = t1.`ID`  AND DELETED = '0' and resolvedDate BETWEEN CONCAT(YEAR(DATE_ADD(now(),INTERVAL -1 day)),'-',month(DATE_ADD(now(),INTERVAL -1 day)),'-',day(DATE_ADD(now(),INTERVAL -1 day)),' 00:00:00') and CONCAT(YEAR(DATE_ADD(now(),INTERVAL -1 day)),'-',month(DATE_ADD(now(),INTERVAL -1 day)),'-',day(DATE_ADD(now(),INTERVAL -1 day)),' 23:59:59'))",
    "name" : "YESTERDAYCLOSEDBUGCNT"
  }, {
    "expression" : "5",
    "name" : "YESTERDAYCONFIRMBUGCNT"
  }, {
    "expression" : "(SELECT COUNT( 1 ) FROM ZT_BUG WHERE PRODUCT = t1.`ID` AND `STATUS` = 'closed' AND DELETED = '0' and CLOSEDDATE BETWEEN CONCAT(YEAR(DATE_ADD(now(),INTERVAL -1 day)),'-',month(DATE_ADD(now(),INTERVAL -1 day)),'-',day(DATE_ADD(now(),INTERVAL -1 day)),' 00:00:00') and CONCAT(YEAR(DATE_ADD(now(),INTERVAL -1 day)),'-',month(DATE_ADD(now(),INTERVAL -1 day)),'-',day(DATE_ADD(now(),INTERVAL -1 day)),' 23:59:59'))",
    "name" : "YESTERDAYRESOLVEDBUGCNT"
  } ],
  "queryCode" : "SELECT\n\t( SELECT COUNT( 1 ) FROM ZT_BUG WHERE PRODUCT = t1.`ID` AND `STATUS` = 'active' AND DELETED = '0' ) AS `ACTIVEBUGCNT`,\n\t( SELECT COUNT( 1 ) FROM ZT_STORY WHERE PRODUCT = t1.`ID` AND `STATUS` = 'active' AND DELETED = '0' ) AS `ACTIVESTORYCNT`,\n\tt1.`CODE`,\n\t(\nSELECT\n\tt.`NAME` \nFROM\n\tzt_project t,\n\tzt_projectproduct t2 \nWHERE\n\tt.id = t2.project \n\tAND t2.product = t1.id \n\tLIMIT 1 \n\t) AS `CURRPROJECT`,\n\tt1.`DELETED`,\n\tt1.`ID`,\n\tt1.`NAME`,\n\t( SELECT COUNT( 1 ) FROM ZT_PRODUCTPLAN WHERE PRODUCT = t1.`ID` AND DELETED = '0' ) AS `PRODUCTPLANCNT`,\n\t( SELECT COUNT( 1 ) FROM ZT_RELEASE WHERE PRODUCT = t1.`ID` AND DELETED = '0' ) AS `RELEASECNT`,\n\tt1.`STATUS`,\n\tt1.`TYPE`,\n\t( CASE WHEN T2.OBJECTORDER IS NOT NULL THEN T2.OBJECTORDER ELSE t1.`ORDER` END ) AS `ORDER1` \nFROM\n\t`zt_product` t1\n\tLEFT JOIN t_ibz_top t2 ON t1.id = t2.OBJECTID \n\tAND t2.type = 'product' \n\tAND t2.ACCOUNT = #{srf.sessioncontext.srfloginname}",
  "id" : "PSMODULES/ibiz/PSDATAENTITIES/ProductStats/PSDEDATAQUERIES/NoOpenProduct/PSDEDQCODES/MYSQL5.json"
}