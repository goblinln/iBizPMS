{
  "dBType" : "MYSQL5",
  "name" : "MySQL5",
  "getPSDEDataQueryCodeConds" : [ {
    "condType" : "CUSTOM",
    "customCond" : "( t11.`PM` =  ${srfsessioncontext('srfloginname','{\"defname\":\"PM\",\"dename\":\"ZT_PROJECT\"}')} )",
    "name" : "查询条件"
  } ],
  "getPSDEDataQueryCodeExps" : [ {
    "expression" : "t1.`ACCOUNT`",
    "name" : "ACCOUNT"
  }, {
    "expression" : "t1.`CONSUMED`",
    "name" : "CONSUMED"
  }, {
    "expression" : "t1.`DAYS`",
    "name" : "DAYS"
  }, {
    "expression" : "t1.`ESTIMATE`",
    "name" : "ESTIMATE"
  }, {
    "expression" : "t1.`HOURS`",
    "name" : "HOURS"
  }, {
    "expression" : "t1.`ID`",
    "name" : "ID"
  }, {
    "expression" : "t1.`JOIN`",
    "name" : "JOIN"
  }, {
    "expression" : "t1.`LEFT`",
    "name" : "LEFT"
  }, {
    "expression" : "t1.`LIMITED`",
    "name" : "LIMITED"
  }, {
    "expression" : "t1.`ORDER`",
    "name" : "ORDER"
  }, {
    "expression" : "t1.`ROLE`",
    "name" : "ROLE"
  }, {
    "expression" : "t1.`ROOT`",
    "name" : "ROOT"
  }, {
    "expression" : "(t1.`DAYS` * t1.`HOURS`)",
    "name" : "TOTAL"
  }, {
    "expression" : "t1.`TYPE`",
    "name" : "TYPE"
  }, {
    "expression" : "(select t.realname from zt_user t where t.account = t1.account)",
    "name" : "USERNAME"
  } ],
  "queryCode" : "SELECT\n\tt1.account,\n\tt1.days,\n\tt1.hours,\n\tt1.id,\n\tt1.`join`,\n\tt1.limited,\n\tt1.`order`,\n\tt1.role,\n\tt1.root,\n\t( t1.days * t1.hours ) AS total,\n\tt1.type,\n\t( SELECT t.realname FROM zt_user t WHERE t.account = t1.account ) AS username,\n\t(\nSELECT\n\tcount( t2.id ) \nFROM\n\tzt_task t2 \nWHERE\n\tt2.deleted = '0' \n\tAND t2.project = t1.root \n\tAND t2.parent >= 0 \n\tAND (\n\tt2.assignedTo = t1.account \n\tOR t2.finishedBy = t1.account \n\tOR t2.id IN ( SELECT t.root FROM zt_team t WHERE t.type = 'task' AND t.account = t1.account ) \n\t) \n\t) AS taskcnt,\n\t(\nSELECT\n\tROUND(sum( CASE WHEN tt.`LEFT` IS NOT NULL THEN tt.`LEFT` ELSE t2.`LEFT` END ), 1) \nFROM\n\tzt_task t2\n\tLEFT JOIN zt_team tt ON tt.root = t2.id \n\tAND tt.type = 'task' \nWHERE\n\tt2.deleted = '0' \n\tAND t2.project = t1.root \n\tAND t2.parent >= 0 \n\tAND ( t2.assignedTo = t1.account OR tt.account = t1.account ) \n\t) AS `left`,\n\t(\nSELECT\n\tROUND(sum( CASE WHEN tt.estimate IS NOT NULL THEN tt.estimate ELSE t2.estimate END ), 1)\nFROM\n\tzt_task t2\n\tLEFT JOIN zt_team tt ON tt.root = t2.id \n\tAND tt.type = 'task' \nWHERE\n\tt2.deleted = '0' \n\tAND t2.project = t1.root \n\tAND t2.parent >= 0 \n\tAND ( t2.assignedTo = t1.account OR tt.account = t1.account ) \n\t) AS `estimate`,\n\t(\nSELECT\n\tROUND(sum( CASE WHEN tt.consumed IS NOT NULL THEN tt.consumed ELSE t2.consumed END ), 1)\nFROM\n\tzt_task t2\n\tLEFT JOIN zt_team tt ON tt.root = t2.id \n\tAND tt.type = 'task' \nWHERE\n\tt2.deleted = '0' \n\tAND t2.project = t1.root \n\tAND t2.parent >= 0 \n\tAND ( t2.assignedTo = t1.account OR tt.account = t1.account ) \n\t) AS consumed ,\n\tt11.`PM`,\nt11.`NAME` AS `PROJECTNAME`,\nDATE_ADD(t1.`join`, INTERVAL t1.days day) as Exitdate\nFROM\n\tzt_team t1 \n\tLEFT JOIN `zt_project` t11 ON t1.`ROOT` = t11.`ID`",
  "id" : "PSMODULES/ibiz/PSDATAENTITIES/ProjectTeam/PSDEDATAQUERIES/ProjectTeamPm/PSDEDQCODES/MYSQL5.json"
}